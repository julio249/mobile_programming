var user_form_data,form_elem,input_elems,message_elem,sendButton,filesLoaded;function msf_sendForm(a,b){a.preventDefault(),user_form_data=new FormData,sendButton=b,_msf(sendButton).css("display","none"),form_elem=_msf(sendButton).parent("form"),input_elems=_msf(form_elem).children(".msf-form-input"),message_elem=_msf(form_elem).child(".msf-form-message"),filesLoaded=0;var c=_msf(form_elem).attr("form-id");user_form_data.append("id",c);var d=!0,e=!1,f=_msf(form_elem).children("input[type='file']"),g=0;0<f.length&&(e=!0,g=f.length);for(var h=0;h<input_elems.length;h++)input_elem_group=_msf(input_elems[h]).parent(".msf-form-field-group"),input_elem_label_span=_msf(input_elem_group).child("label span"),void 0!==input_elem_label_span&&_msf(input_elem_label_span).remove(),_msf(input_elem_group).removeClass("error"),_msf(message_elem).removeClass("error"),"Y"==_msf(input_elems[h]).attr("data-required")?""==_msf(input_elems[h]).val()?(_msf(_msf(input_elems[h]).next()).append("<span> - This is required.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"INPUT"==input_elems[h].tagName&&"email"==_msf(input_elems[h]).attr("type")?msf_sendIsValidEmail(_msf(input_elems[h]).val())?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):(_msf(_msf(input_elems[h]).next()).append("<span> - This requires a valid email.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"SELECT"==input_elems[h].tagName?"NO OPTION SELECTED"==_msf(input_elems[h]).val()?(_msf(_msf(input_elems[h]).next()).append("<span> - Please select an option.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):"INPUT"==input_elems[h].tagName&&"text"==_msf(input_elems[h]).attr("type")||"date"==_msf(input_elems[h]).attr("type")||"hidden"==_msf(input_elems[h]).attr("type")||"TEXTAREA"==input_elems[h].tagName?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):"INPUT"==input_elems[h].tagName&&"file"==_msf(input_elems[h]).attr("type")?msf_checkFormFileSize(input_elems[h])?msf_readAndAttach(input_elems[h]):(_msf(_msf(input_elems[h]).next()).append("<span> - This file size is too large to upload.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"INPUT"==input_elems[h].tagName&&"tel"==_msf(input_elems[h]).attr("type")&&(msf_sendIsValidPhone(_msf(input_elems[h]).val())?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):(_msf(_msf(input_elems[h]).next()).append("<span> - This requires a valid phone number.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1)):"INPUT"==input_elems[h].tagName&&"email"==_msf(input_elems[h]).attr("type")&&""!=_msf(input_elems[h]).val()?msf_sendIsValidEmail(_msf(input_elems[h]).val())?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):(_msf(_msf(input_elems[h]).next()).append("<span> - This requires a valid email.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"INPUT"==input_elems[h].tagName&&"text"==_msf(input_elems[h]).attr("type")||"date"==_msf(input_elems[h]).attr("type")||"hidden"==_msf(input_elems[h]).attr("type")||"TEXTAREA"==input_elems[h].tagName||"SELECT"==input_elems[h].tagName?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):"INPUT"==input_elems[h].tagName&&"file"==_msf(input_elems[h]).attr("type")?0==input_elems[h].files.length?(fileID=_msf(input_elems[h]).attr("name"),user_form_data.append(fileID,"NO FILE UPLOADED"),filesLoaded++):msf_checkFormFileSize(input_elems[h])?msf_readAndAttach(input_elems[h]):(_msf(_msf(input_elems[h]).next()).append("<span> - This file size is too large to upload.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"INPUT"==input_elems[h].tagName&&"tel"==_msf(input_elems[h]).attr("type")&&""!=_msf(input_elems[h]).val()?msf_sendIsValidPhone(_msf(input_elems[h]).val())?user_form_data.append(_msf(input_elems[h]).attr("name"),_msf(input_elems[h]).val()):(_msf(_msf(input_elems[h]).next()).append("<span> - This requires a valid phone number.</span>"),_msf(_msf(input_elems[h]).parent(".msf-form-field-group")).addClass("error"),d=!1):"INPUT"==input_elems[h].tagName&&"checkbox"==_msf(input_elems[h]).attr("type")?(check_value=_msf(input_elems[h]).attr("value"),extra_data="",check_value.includes("|")&&(pipe_pos=check_value.indexOf("|"),extra_data=check_value.substring(pipe_pos),check_value=check_value.substring(0,pipe_pos)),!0==_msf(input_elems[h])[0].checked&&user_form_data.append(_msf(input_elems[h]).attr("msf-field-label")+" - "+check_value,"Yes"+extra_data)):"INPUT"==input_elems[h].tagName&&"radio"==_msf(input_elems[h]).attr("type")&&!0==_msf(input_elems[h])[0].checked&&user_form_data.append(_msf(input_elems[h]).attr("msf-field-label"),_msf(input_elems[h]).attr("value"));if(d){_msf(message_elem).html("<div style=\"margin-right: 10px;\">Please wait while your form is sent...</div><div class=\"lds-ring\"><div></div><div></div><div></div><div></div></div>");var j=function(){filesLoaded==g?msf_sendFormData():setTimeout(j,500)};j()}else _msf(sendButton).css("display","inline-block"),_msf(message_elem).text("There are errors on the form. Please correct the errors and try again."),_msf(message_elem).addClass("error")}function msf_sendFormData(){msfAjax2({url:msf_config.site_url+"api/front-end/forms/",data:user_form_data,success:function(a){var a=JSON.parse(a);if("success"==a.result){var b=_msf(form_elem).children(".msf-form-field-group");[].forEach.call(b,function(a){_msf(a).css("display","none")}),[].forEach.call(input_elems,function(a){_msf(a).css("display","none")});var c=_msf(form_elem).children("label");[].forEach.call(c,function(a){_msf(a).css("display","none")});var d=_msf(form_elem).children(".msf-form-helper-text");[].forEach.call(d,function(a){_msf(a).css("display","none")});var e=_msf(form_elem).children(".msf-form-label-only");[].forEach.call(e,function(a){_msf(a).css("display","none")}),extra="formSubmit_"+user_form_data.get("id"),0<a.redirect?(window[extra](),window.location=a.redirect_url):(_msf(message_elem).html(a.message),window[extra]())}else"error"==a.result?(_msf(message_elem).text(a.message),_msf(sendButton).css("display","inline-block")):(_msf(message_elem).text("There was an error sending the form. Please try again in a moment."),_msf(sendButton).css("display","inline-block"))}})}function msf_sendIsValidEmail(a){const b=new Set(["testing@example.com"]);if(b.has(a))return!1;var c=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return c.test(a)}function msf_sendIsValidPhone(a){const b=new Set(["(111) 111-1111","(222) 222-2222","(333) 333-3333","(444) 444-4444","(555) 555-5555","(666) 666-6666","(777) 777-7777","(888) 888-8888","(999) 999-9999"]);if(b.has(a))return!1;var c=new RegExp(/^\(?([2-9][0-9]{2})\)?[-. ]?([2-9](?!11)[0-9]{2})[-. ]?([0-9]{4})$/);return c.test(a)}function msf_setFormFieldsFocusOut(){_msf(".msf-form-input").on("change",function(){""==_msf(this).val()?_msf(this).removeClass("filled"):_msf(this).addClass("filled")})}function msf_setFormFieldsTel(){_msf("input[type='tel']").on("input",function(a){var b=a.target.value.replace(/\D/g,"").match(/(\d{0,3})(\d{0,3})(\d{0,4})/);a.target.value=b[2]?"("+b[1]+") "+b[2]+(b[3]?"-"+b[3]:""):b[1]})}function msf_readAndAttach(a){var b=new FileReader;b.onload=function(b){fileID=_msf(a).attr("name"),fileName=a.files[0].name,user_form_data.append(fileID,b.target.result),user_form_data.append(fileID+"-FILENAME",fileName),filesLoaded++},b.readAsDataURL(a.files[0])}function msf_checkFormFileSize(a){let b=msf_config.media_max.slice(-2),c=parseInt(msf_config.media_max.slice(0,-2)),d=1e6;"KB"==b?d=1e3:"GB"==b&&(d=1e9);let e=c*d;return!!(a.files[0].size<e)}function msf_setFormFileAttachment(a){var b=a.nextElementSibling,c=_msf(a).attr("name");if(a.files&&a.files[0]){var d=new FileReader;d.onload=function(){inputFilename=a.files[0].name,c+=" - File Attached: "+inputFilename,_msf(b).text(c)},d.readAsDataURL(a.files[0])}}function msf_resetForm(a){form=_msf("[form-id='"+a+"']"),mE=form.child(".msf-form-message"),sB=form.child(".msf-form-submit"),fI=form.children(".msf-form-input"),fL=form.children("label"),_msf(mE).text(""),_msf(mE).removeClass("error"),_msf(sB).css("display","inline-block"),[].forEach.call(fI,function(a){_msf(a).css("display","inline"),_msf(a).val(""),_msf(a).removeClass("filled")}),[].forEach.call(fL,function(a){_msf(a).css("display","inline")}),msf_setFormFieldsFocusOut(),msf_setFormFieldsTel()}document.addEventListener("DOMContentLoaded",function(){msf_setFormFieldsFocusOut(),msf_setFormFieldsTel()});